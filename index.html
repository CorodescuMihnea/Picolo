<html>
<head>
	</head>

<body>
	  <script type="text/javascript" src="/loadSW.js"></script>

	<form id="image_form">
		Url:<input type="text" name="url">
		W:<input type="text" name="width">
		H:<input type="text" name="height">
		<input type="submit">
	</form>

	
</body>

</html>

<script>

if (navigator.serviceWorker.controller) {
        var messageChannel = new MessageChannel();
        messageChannel.port1.onmessage = function(event) {
            console.log("Response from the SW : ", event.data.message);
        }
    }
        else {
        console.log("No active ServiceWorker");
    }

	document.getElementById("image_form").addEventListener("submit", function(event){
 event.preventDefault();

 
   var url=this.elements["url"].value;
   var width=this.elements["width"].value;
   var height=this.elements["height"].value;
 

        console.log("Sending message to the service worker");
        navigator.serviceWorker.controller.postMessage({
            "command": "twoWayCommunication",
            "message": "hi",
            "url" : url ,
            "width" : width,
            "hieght" : height
        }, [messageChannel.port2]);
    
 
});

 navigator.serviceWorker.addEventListener('message', event => {
  console.log(event.data);
});
/*
	var worker= new Worker('C:\\Users\\Alex\\Desktop\\Picolo\\PiColo\\service_worker.js');

	worker.addEventListener('message', function(e) {
  console.log('Worker said: ', e.data);
}, false);
	

		document.getElementById("image_form").addEventListener("submit", function(event){
  event.preventDefault();



console.log(this.elements["url"].value);
  var url=this.elements["url"].value;
  var width=this.elements["width"].value;
    var width=this.elements["height"].value;

	worker.postMessage(url); 


});*/
</script>